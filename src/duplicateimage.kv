#:kivy 1.0.9
#:import kivy kivy
#:import win kivy.core.window

<StartMenuScreen>:
    BoxLayout:
        size: root.size
        pos: root.pos
        orientation: "vertical"
        FileChooserListView:
            id: filechooser
            filters: [root.filter]

        BoxLayout:
            size_hint_y: None
            height: 30
            Button:
                text: "Cancel"
                on_release: root.cancel()
            Button:
                text: "Load"
                on_release: root.manager.start_search(filechooser.path)

<DuplicateFinderProgressBar>:
    ProgressBar:
        id: _progress_bar
        max: root.total
        value: root.index


<DuplicateFinderEstimatingProgressBar>:
    Label:
        text: root.estimate_text_prefix + root.estimate_text
        pos_hint: {'right': 1, 'center_y': 0.55}
        size_hint: (None, None)
        size: self.texture_size
    Label:
        text: root.path
        text_size: (.5 * root.width, None)
        shorten: True
        split_str: '\\'
        pos_hint: {'left': 0, 'center_y': 0.55}
        size_hint: (None, None)
        size: self.texture_size
    ProgressBar:
        id: _progress_bar
        max: root.total
        value: root.index


<DuplicateFinderProgressLayoutBase>:
    progress_bar: placeholder

    on_start: start_stop_button.text = '||'
    on_stop: start_stop_button.text = '>'
    on_resume: start_stop_button.text = '||'

    BoxLayout:
        padding: 10
        spacing: 10
        Placeholder:
            id: placeholder
        Button:
            id: cancel_button
            size: (40, 40)
            size_hint: (None, None)
            pos_hint: {'center_y': 0.5}
            text: "x"
            on_release: root.controller.cancel()
        Button:
            id: start_stop_button
            size: (40, 40)
            size_hint: (None, None)
            pos_hint: {'center_y': 0.5}
            on_release: root.controller.start_stop()


<SelectableLabel>:
    # Draw a background to indicate selection
    canvas.before:
        Color:
            rgba: (.0, 0.9, .1, .3) if self.selected else (0, 0, 0, 1)
        Rectangle:
            pos: self.pos
            size: self.size


<SelectableGridDataView>:
    widgetclass: 'SelectableLabel'
    padding: 20
    cols: 2
    multiselect: True
    touch_multiselect: True


<DuplicateManager>:
    viewclass: 'SelectableGridDataView'
    SelectionRecycleBoxLayout:
        default_size: None, None
        default_size_hint: 1, None
        size_hint_y: None
        height: self.minimum_height
        orientation: 'vertical'
        multiselect: True
        touch_multiselect: True


<DuplicateManagerScreen>:
    BoxLayout:
        orientation: 'vertical'
        DuplicateManager:
            id: _recycle_view
        Button:
            text: 'Delete'
            on_release: _recycle_view.remove_selected()
            

<Picture>:
    # each time a picture is created, the image can delay the loading
    # as soon as the image is loaded, ensure that the center is changed
    # to the center of the screen.
    on_size: self.center = win.Window.center
    size: image.size
    size_hint: None, None

    Image:
        id: image
        source: root.source

        # create initial image to be 400 pixels width
        size: 400, 400 / self.image_ratio

        # add shadow background
        canvas.before:
            Color:
                rgba: 1,1,1,1
            BorderImage:
                source: 'shadow32.png'
                border: (36,36,36,36)
                size: (self.width+72, self.height+72)
                pos: (-36,-36)